/*!
* @name autocomplete
* @version 1.9.0
* @author Grzegorz Tomicki
* @link https://github.com/tomickigrzegorz/autocomplete
* @license MIT
*/
!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(t="undefined"!=typeof globalThis?globalThis:t||self).Autocomplete=s()}(this,(function(){"use strict";const t=(t,s)=>{for(let i in s)"addClass"===i?e(t,"add",s[i]):"removeClass"===i?e(t,"remove",s[i]):t.setAttribute(i,s[i])},s=t=>(t.firstElementChild||t).textContent.trim(),i=(t,s)=>{t.scrollTop=t.offsetTop-s.offsetHeight},h=function(t,s){void 0===t&&(t=!1),t&&(e(t,"remove","hidden"),r(t,"click",s))},e=(t,s,i)=>t.classList[s](i),n=(s,i)=>{t(s,{"aria-activedescendant":i||""})},a=(t,s,i,h)=>{const e=h.previousSibling,n=e?e.offsetHeight:0;if("0"==t.getAttribute("aria-posinset")&&(h.scrollTop=t.offsetTop-((t,s)=>{const i=document.querySelectorAll(`#${t} > li:not(.${s})`);let h=0;return[].slice.call(i).map((t=>h+=t.offsetHeight)),h})(s,i)),t.offsetTop-n<h.scrollTop)h.scrollTop=t.offsetTop-n;else{const s=t.offsetTop+t.offsetHeight-n;s>h.scrollTop+h.offsetHeight&&(h.scrollTop=s-h.offsetHeight)}},l=t=>document.createElement(t),o=t=>document.querySelector(t),r=(t,s,i)=>{t.addEventListener(s,i)},c=(t,s,i)=>{t.removeEventListener(s,i)},d=27,u=13,m=38,p=40,f=9;return class{constructor($,b){let{delay:v=500,clearButton:x=!0,clearButtonOnInitial:y=!1,howManyCharacters:C=1,selectFirst:k=!1,insertToInput:g=!1,showAllValues:j=!1,cache:w=!1,disableCloseOnSelect:S=!1,preventScrollUp:V=!1,classGroup:O,classPreventClosing:I,classPrefix:T,ariaLabelClear:R,onSearch:A,onResults:B=(()=>{}),onSubmit:P=(()=>{}),onOpened:G=(()=>{}),onReset:J=(()=>{}),onRender:N=(()=>{}),onClose:q=(()=>{}),noResults:z=(()=>{}),onSelectedItem:E=(()=>{})}=b;var F;this.t=()=>{var s,i,e,n,a;this.i(),s=this.h,i=this.l,e=this.o,n=this.u,a=this.m,t(i,{id:e,tabIndex:"0",role:"listbox"}),t(n,{addClass:`${a}-results-wrapper`}),n.insertAdjacentElement("beforeend",i),s.parentNode.insertBefore(n,s.nextSibling),r(this.h,"input",this.p),this.$&&r(this.h,"click",this.p),this.v({element:this.h,results:this.l}),this.C&&h(this.k,this.destroy)},this.j=(t,s)=>{this.S&&("update"===t?this.h.setAttribute(this.V,s.value):"remove"===t?this.h.removeAttribute(this.V):this.h.value=this.h.getAttribute(this.V))},this.p=t=>{let{target:s,type:i}=t;if("true"===this.h.getAttribute("aria-expanded")&&"click"===i)return;const h=s.value.replace(this.O,"\\$&");this.j("update",s);const e=this.$?0:this.I;clearTimeout(this.T),this.T=setTimeout((()=>{this.R(h.trim())}),e)},this.A=()=>{var s;e(this.u,"remove",this.B);const i={"aria-owns":`${this.P}-list`,"aria-expanded":"false","aria-autocomplete":"list",role:"combobox",removeClass:"auto-expanded"},h=this.G?i:{...i,"aria-activedescendant":""};t(this.h,h),this.G||(this.J(o(`.${this.N}`)),this.q=this.F?0:-1),(0==(null==(s=this.L)?void 0:s.length)&&!this.M||this.$)&&(this.l.textContent=""),this.U()},this.R=t=>{this.D=t,this.H(!0),h(this.k,this.destroy),0==t.length&&this.K&&e(this.k,"add","hidden"),this.W>t.length&&!this.$?this.H():this.X({currentValue:t,element:this.h}).then((s=>{const i=this.h.value.length,h=s.length;this.L=Array.isArray(s)?s:JSON.parse(JSON.stringify(s)),this.H(),this.Y(),0==h&&0==i&&e(this.k,"add","hidden"),0==h&&i?(e(this.h,"remove","auto-expanded"),this.A(),this.Z({element:this.h,currentValue:t,template:this._}),this.tt()):(h>0||(t=>t&&"object"==typeof t&&t.constructor===Object)(s))&&(this.q=this.F?0:-1,this._(),this.tt())})).catch((()=>{this.H(),this.A()}))},this.H=t=>this.h.parentNode.classList[t?"add":"remove"](this.st),this.Y=()=>e(this.h,"remove",this.it),this.tt=()=>{r(this.h,"keydown",this.ht),r(this.h,"click",this.et),r(document,"click",this.nt),["mousemove","click"].map((t=>{r(this.l,t,this.lt)}))},this._=s=>{t(this.h,{"aria-expanded":"true",addClass:`${this.m}-expanded`}),this.l.textContent="";const h=0===this.L.length?this.ot({currentValue:this.D,matches:0,template:s}):this.ot({currentValue:this.D,matches:this.L,classGroup:this.rt});this.l.insertAdjacentHTML("afterbegin",h),e(this.u,"add",this.B);const n=this.rt?`:not(.${this.rt})`:"";this.ct=document.querySelectorAll(`#${this.o} > li${n}`),(s=>{for(let i=0;i<s.length;i++)t(s[i],{role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":s.length,"aria-posinset":i})})(this.ct),this.dt({type:"results",element:this.h,results:this.l}),this.ut(),i(this.l,this.u)},this.nt=t=>{let{target:s}=t,i=null;(s.closest("ul")&&this.ft||s.closest(`.${this.$t}`))&&(i=!0),s.id===this.P||i||this.A()},this.ut=()=>{if(this.J(o(`.${this.N}`)),!this.F)return;const{firstElementChild:s}=this.l,i=this.rt&&this.L.length>0&&this.F?s.nextElementSibling:s;this.bt({index:this.q,element:this.h,object:this.L[this.q]}),t(i,{id:`${this.vt}-0`,addClass:this.N,"aria-selected":"true"}),n(this.h,`${this.vt}-0`)},this.et=()=>{if(this.l.textContent.length>0&&!e(this.u,"contains",this.B)){if(t(this.h,{"aria-expanded":"true",addClass:`${this.m}-expanded`}),e(this.u,"add",this.B),this.G||(i(this.l,this.u),this.ut()),this.dt({type:"showItems",element:this.h,results:this.l}),!this.S)return;this.j("update",this.h)}},this.lt=t=>{t.preventDefault();const{target:s,type:i}=t,h=s.closest("li"),n=null==h?void 0:h.hasAttribute("role"),a=this.N,l=o(`.${a}`);h&&n&&!s.closest(`.${this.$t}`)&&("click"===i&&this.xt(h),"mousemove"!==i||e(h,"contains",a)||(this.J(l),this.yt(h),this.q=this.Ct(h),this.bt({index:this.q,element:this.h,object:this.L[this.q]})))},this.xt=t=>{t&&0!==this.L.length?(this.K&&e(this.k,"remove","hidden"),this.h.value=s(t),this.kt({index:this.q,element:this.h,object:this.L[this.q],results:this.l}),this.ft||(this.G||this.J(t),this.A()),this.j("remove")):!this.ft&&this.A()},this.Ct=t=>Array.prototype.indexOf.call(this.ct,t),this.ht=t=>{const{keyCode:i}=t,h=e(this.u,"contains",this.B),a=this.L.length+1;switch(this.gt=o(`.${this.N}`),i){case m:case p:if(t.preventDefault(),a<=1&&this.F||!h)return;if(i===m?(this.q<0&&(this.q=a-1),this.q-=1):(this.q+=1,this.q>=a&&(this.q=0)),this.J(this.gt),this.q>=0&&this.q<a-1){const t=this.ct[this.q];this.M&&h&&(this.h.value=s(t)),this.bt({index:this.q,element:this.h,object:this.L[this.q]}),this.yt(t)}else this.j(),n(this.h),this.bt({index:null,element:this.h,object:null});break;case u:t.preventDefault(),this.xt(this.gt);break;case f:case d:t.stopPropagation(),this.A()}},this.yt=s=>{const i=`${this.vt}-${this.Ct(s)}`;t(s,{id:i,"aria-selected":"true",addClass:this.N}),n(this.h,i),a(s,this.o,this.rt,this.l)},this.J=s=>{s&&t(s,{id:"",removeClass:this.N,"aria-selected":"false"})},this.i=()=>{this.K&&(t(this.k,{class:`${this.m}-clear hidden`,type:"button",title:this.jt,"aria-label":this.jt}),this.h.insertAdjacentElement("afterend",this.k))},this.rerender=t=>{const s=null!=t&&t.trim()?t.trim():this.h.value;null!=t&&t.trim()&&(this.h.value=t.trim(),this.j("update",this.h));const i=s.replace(this.O,"\\$&");this.R(i.trim())},this.destroy=()=>{this.K&&e(this.k,"add","hidden"),this.h.value="",this.h.focus(),this.l.textContent="",this.A(),this.Y(),this.wt(this.h),c(this.h,"keydown",this.ht),c(this.h,"click",this.et),c(document,"click",this.nt)},this.P=$,this.h=document.getElementById($),this.X=(F=A,Boolean(F&&"function"==typeof F.then)?A:t=>{let{currentValue:s,element:i}=t;return Promise.resolve(A({currentValue:s,element:i}))}),this.ot=B,this.v=N,this.kt=P,this.bt=E,this.dt=G,this.wt=J,this.Z=z,this.U=q,this.I=v,this.W=C,this.K=x,this.C=y,this.F=k,this.M=g,this.$=j,this.rt=O,this.$t=I,this.jt=R||"clear the search query",this.m=T?`${T}-auto`:"auto",this.ft=S,this.G=V,this.S=w,this.o=`${this.m}-${this.P}-results`,this.V=`data-cache-auto-${this.P}`,this.st=`${this.m}-is-loading`,this.B=`${this.m}-is-active`,this.N=`${this.m}-selected`,this.vt=`${this.m}-selected-option`,this.it=`${this.m}-error`,this.O=/[|\\{}()[\]^$+*?.]/g,this.T=null,this.u=l("div"),this.l=l("ul"),this.k=l("button"),this.t()}}}));
